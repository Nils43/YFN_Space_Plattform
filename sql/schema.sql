CREATE TABLE IF NOT EXISTS resources (
  id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  type TEXT NOT NULL CHECK (type IN ('DESK','ROOM','BOOTH')),
  name TEXT NOT NULL,
  location TEXT,
  capacity INT DEFAULT 1
);

CREATE TABLE IF NOT EXISTS bookings (
  id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  user_name TEXT NOT NULL,
  resource_id INT NOT NULL REFERENCES resources(id) ON DELETE CASCADE,
  start_at TIMESTAMPTZ NOT NULL,
  end_at TIMESTAMPTZ NOT NULL,
  created_at TIMESTAMPTZ NOT NULL DEFAULT NOW()
);

CREATE INDEX IF NOT EXISTS idx_bookings_resource_time
ON bookings (resource_id, start_at, end_at);
